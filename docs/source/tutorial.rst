快速上手
--------

.. tip::
    推荐观看视频：《从pyETRC到qETRC操作逻辑变化简介》 https://www.bilibili.com/video/BV1334y1X7Wr/
    本视频对操作逻辑做了一整体介绍，特别推荐使用过pyETRC的用户观看。

程序主界面
~~~~~~~~~~

程序主界面如下图所示。

.. image:: /_static/img/tutorial/main.png
    :alt: 程序主界面

主要包含以下部分：

- 正中央占据最大空间的\ **运行图窗口**\ 。
- 窗口顶部、运行图窗口以上为 **工具栏** 。本软件采用Ribbon风格的工具栏，由\ `SARibbon <https://github.com/czyt1988/SARibbon/>`_\ 提供支持。其中：

    - 左上角按钮 ``文件`` 包含打开、保存等基本的文件操作。
    - ``开始`` 至 ``显示`` 四个页面为基本的 **工具栏页面** ，包含基本操作，在程序运行过程中始终显示。
    - 右侧带背景的 ``运行图`` ``线路工具`` 等选项卡为 **上下文页面** 或 **上下文选项卡** ，是针对运行图文件中某一特定元素（运行图页面、线路、列车等）的具体操作，程序启动时不显示，只有当选择到具体元素时，才显示。也可手动关闭。
    - 右上角有撤销、重做、关闭选项卡、关闭窗口等操作。

- 运行图窗口左右两侧为\ **停靠面板**\ 区域，用户可以自行开关窗口、移动位置等。默认情况下，启动时包含四个窗口：

    - 运行图资源管理器，运行图中所有数据元素的列表，详见下节。
    - 历史记录，包含目前执行的所有（可撤销的）操作列表。
    - 速览时刻、速览信息：当前选中车次的时刻表和重要的统计信息。
- 底部为状态栏，显示最近执行的操作（部分）

所有的停靠面板都可以拖动改变位置、悬浮或者关闭，例如下图所示

.. figure:: /_static/img/tutorial/ads.png
    :alt: 停靠面板操作

此功能由 `Qt-Advanced-Docking-System <https://github.com/githubuser0xFFFF/Qt-Advanced-Docking-System/>`_ 库提供支持，可参阅相关文档获得更多支持。
所有关闭的停靠面板皆可在工具栏中找到对应的开关，重新打开。

.. note:: 
    运行图窗口实质上也是一个停靠面板，支持拖动、关闭、悬浮等操作。

运行图文件结构
~~~~~~~~~~~~~~

在本文档中，一个\ **运行图文件**\ 是指一个由本软件直接打开、保存的、磁盘上的物理文件。运行图资源管理器以最清晰、简洁的方式展示了运行图文件的（逻辑）结构，如下图所示：

.. figure:: /_static/img/tutorial/struct.png
    :alt: 运行图资源管理器

主要包含：

（1）一组\ **线路**\ ，或者\ **基线**\ 。每条线路是指一段连续的铁路线路，原则上具有线性结构。一个运行图文件可以包含多条线路。每条线路包含如下数据：

- 线路\ **站表**\ ，或称里程表，给出每个站的站名、里程等基本信息。
- \ **标尺**\ ，或称区间运行时分标准，给出列车在线路每个区间运行的耗时。一条线路可以包含多套标尺，或不包含任何标尺。
- \ **天窗**\ ，规定线路每日检修时段。目前每条线路支持两套天窗数据，即综合维修天窗、综合施工天窗。

.. note::
    pyETRC中每个运行图文件只能有一条线路，但qETRC支持多条线路。如果打开由pyETRC保存的文件，可以正确读取线路；但如果用pyETRC打开本系统保存的多线路文件，则只能读取到第一条线路。

（2）一组\ **运行图页面**\ ，或称\ **运行图视窗**\ ，在不至于引起误会时也简称运行图。一个运行图页面对应程序中运行图窗口的一个页面，可以包含一条或多条线路。一条线路可以同时属于多个运行图页面，亦可不属于任何运行图页面。

.. note::
    pyETRC中没有运行图页面的概念。使用qETRC打开pyETRC保存的文件（或其他任何没有运行图页面的运行图文件），会自动以运行图中的线路创建一个默认运行图页面。

（3）一组\ **列车**\ 。每趟列车包含其车次、类型、时刻表等数据。

（4）一组\ **交路**\ 。交路描述车底的周转情况，是一组列车的有序序列。一趟列车只能属于至多一个交路，或不属于任何交路。

以上统称为运行图的\ **数据元素**\ 。在运行图资源管理器中右击或者双击数据元素或分类，可以执行添加、删除、编辑、创建副本等基本操作。

.. image:: _static/img/tutorial/navi-context.png
    :alt: 右键菜单


常用基本操作
~~~~~~~~~~~~

选中车次，右键菜单，资源管理器，Context




后续..
~~~~~~~

* 文件格式，导入导出
* 基本数据管理
* 微调与修订
* 显示控制 （包括Ads和Ribbon相关）
* 分析
* 排图
* 路网管理
