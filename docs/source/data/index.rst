运行图数据管理
--------------

本章介绍运行图各种数据元素的基本编辑。对于每一种数据元素，首先给出（用户层面需要了解的）概念性的内容，然后说明其基本的查看编辑方法。除了本章介绍的基本编辑方法外，对于一些特定的场景，软件可能已经设计好了一些更方便的数据调整方法，请参见\ :doc:`/modify/index`\ 。

运行图数据元素及选择
~~~~~~~~~~~~~~~~~~~~~~~~
    
在 :ref:`快速上手<sec_file_struct>` 中已经介绍过，在qETRC中，一个运行图文件包含线路（含标尺、天窗）、列车、列车径路、交路等 **数据元素** 。这些数据元素可以在运行图资源管理器中统一查看并做简单的编辑。

对于一部分数据元素，存在 **当前** 或 **选中** 数据元素的概念，例如当前车次、当前线路等。若数据元素被选中，则它成为工具栏上下文页面所编辑的对象，这可以由页面所显示的数据对象名称来确认，例如下图所示。

.. figure:: /_static/img/data/context-name.png
    :alt: 上下文页面中显示的数据元素名称

除此之外，某些功能，例如标尺对照、列车事件表等，也会自动使用当前选中的数据元素。

数据元素通常可以由以下方式选中：

- 在运行图资源管理器中点击（选择）到数据元素。
- 在某些数据元素的管理面板中，选择到数据元素。例如列车管理面板、交路管理面板等。
- 在运行图上选中运行线，则自动选中该运行线对应的车次、该运行线所在的线路及运行图页面。
- 某些数据元素可以在其他面板中通过 ``转到`` 按钮（或相应图标）实现切换。

自V1.7.2版本起，新增切换选中数据元素功能。在各数据元素的上下文页面中（例如上图所示），可以通过点击 :guilabel:`切换` 按钮（或图标），选择新的数据元素。

固定对象编辑面板和同步编辑面板
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

在以往的pyETRC中，“当前车次编辑”停靠面板中，编辑的总是当前选中的车次。如果选中车次切换，则停靠面板所编辑的车次随之切换。这种模式我们称为 **同步编辑面板** 。
在qETRC中，绝大多数的面板采用另一种组织形式。例如，若打开 ``基线编辑`` 窗口（停靠面板）编辑某基线A，然后通过某些操作重新选中基线B，使之成为当前选中的基线对象，此前打开的基线A的编辑面板仍是A的编辑面板，其编辑对象不会变成B。如果此时再打开一个 ``基线编辑`` 面板，则会打开一个新的面板，以编辑基线B。在这种模式下，每个面板所编辑的数据对象是固定的，且不会改变，故称为 **固定对象编辑面板** 。

在早期的qETRC中，主要数据元素的编辑面板都是固定对象编辑面板。自V1.7.2版本起，在 ``列车编辑`` 和 ``交路编辑`` 中新增了切换对象的按钮，并新增了设置为同步编辑面板的选项（如下图所示）。若同步面板的按钮为选中状态，则当前停靠面板进入同步编辑面板状态，所编辑的对象随着所选对象的变化而变化。

.. figure:: /_static/img/data/train-edit-sync.png
    :alt: 列车编辑面板同步-V1.7.3


.. toctree::
    
    rail
    train
    circuit


